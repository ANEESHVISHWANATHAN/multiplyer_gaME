<!DOCTYPE html>
<html>
<head>
    <title>Join Lobby</title>
</head>
<body>
    <h1>Enter Your Details</h1>
    <label>Username:</label> 
    <input type="text" id="username"><br>
    <label>Choose Icon:</label> 
    <input type="file" id="icon" accept="image/*"><br>
    <label>Enter Room Code:</label> 
    <input type="text" id="roomID" maxlength="5"><br>
    <button onclick="joinLobby()">Submit</button>

    <script>
     


function joinLobby() {
    
    const username = document.getElementById("username").value;
    const iconFile = document.getElementById("icon").files[0];
    const roomID = document.getElementById("roomID").value;
    username.textContent = "fuck off";
    console.log("see");
    if (username && iconFile && roomID) {
        document.write("yes");
        console.log("perfect");
        const reader = new FileReader();
        reader.onload = () => {
            const socket = new WebSocket('wss://multiplyer-game.onrender.com'); 

            localStorage.setItem("username", username);
            localStorage.setItem("icon", reader.result);
            localStorage.setItem("host", false);
            

                
           
            socket.onopen = () => {
                    socket.send(JSON.stringify({ type: "joinLobby", roomID, username, icon: reader.result }));
                };
            socket.onmessage = (event) => {
    const message = JSON.parse(event.data);
    if (message.type === "lobbyJoined") {
        
        window.location.href = `lobby.html?roomID=${roomID}`;
    } 
};
            }
        };
        reader.readAsDataURL(iconFile);
    }
else{
    document.write("big fat error");
    console.log("errikfknfj");
}
</script>

</body>
</html>
