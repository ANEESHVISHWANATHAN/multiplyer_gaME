<!-- Player Section -->
<div class="player-section" id="playerSection">
    <!-- Remove the hardcoded Anuj card -->
</div>

<script>
    const socket = new WebSocket('ws://localhost:3000');

    socket.addEventListener('open', () => {
        console.log('Connected to server');

        // Retrieve data from localStorage
        const username = localStorage.getItem('username');
        const icon = localStorage.getItem('icon');

        if (username && icon) {
            createLobby(username, icon);
        }
    });

    function createLobby(username, icon) {
        socket.send(JSON.stringify({ type: 'createLobby', username, icon }));

        // Add the host card dynamically
        const playerSection = document.getElementById('playerSection');
        playerSection.innerHTML = `
            <div class="player-card">
                <img src="${icon}" alt="${username}" />
                <p>${username} (Host)</p>
                <div class="host-symbol">H</div>
            </div>
        `;
    }

    socket.addEventListener('message', (event) => {
        const message = JSON.parse(event.data);

        if (message.type === 'updateLobby') {
            const playerSection = document.getElementById('playerSection');
            playerSection.innerHTML = '';

            message.players.forEach(player => {
                const card = document.createElement('div');
                card.className = 'player-card';
                card.innerHTML = `
                    <img src="${player.icon}" alt="${player.username}" />
                    <p>${player.username}</p>
                `;
                
                if (!player.isHost) {
                    card.innerHTML += `
                        <img src="exit.png" class="kick-btn" onclick="kickPlayer('${player.username}')" />
                        <img src="host.png" class="make-host-btn" onclick="makeHost('${player.username}')" />
                    `;
                } else {
                    card.innerHTML += `<div class="host-symbol">H</div>`;
                }
                playerSection.appendChild(card);
            });
        }
    });

    function kickPlayer(username) {
        socket.send(JSON.stringify({ type: 'kickPlayer', playerID: username }));
    }

    function makeHost(username) {
        socket.send(JSON.stringify({ type: 'makeHost', playerID: username }));
    }
</script>
